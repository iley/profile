set nocompatible

" user commands
command! -nargs=0 -bang WSudo :silent! w !sudo tee % &>/dev/null
command! -nargs=0 Vimrc :tabnew $MYVIMRC

set encoding=utf-8

" workaround for fish shell
set shell=/bin/bash

" workaround for deprecation warning in python
silent! py3 pass

" disable mouse
set mouse="

" indentation settings
set tabstop=4
set shiftwidth=4
set expandtab
set smartindent
set shiftround " remove extra spaces during indentation

set nowrap

" search and replace
set ignorecase
set smartcase
set hlsearch

set updatetime=120000
set hidden

" folding settings
set foldlevelstart=20

" move to next line at beginning/line of the current
set whichwrap=h,l,<,>,[,]

" turn off speaker
set vb t_vb="

set wildignore+=*.o,*.bak,*.pyc,*.jpg,*.png,*/.git/*,*/.hg/*,*/.svn/*

augroup misc
    au! BufNewFile,BufRead * setlocal vb t_vb="

    " do not highlight tabs and stuff for taskpaper and golang sources
    au! BufNewFile,BufRead *.taskpaper setlocal nolist
    au! BufNewFile,BufRead *.go setlocal nolist
augroup end

set undolevels=1000
set undoreload=10000
set undodir=~/.vim/undo
set undofile

" store swap files in a separate directory
set directory=~/.vim/swap

" Suffixes that get lower priority when doing tab completion for filenames.
set suffixes=.bak,~,.swp,.o,.info,.aux,.log,.dvi,.bbl,.blg,.brf,.cb,.ind,.idx,.ilg,.inx,.out,.toc
set suffixesadd=.pl,.pm,.yml,.yaml " for `gf' (open file under cursor)

" Complete options (disable preview scratch window)
set completeopt=menu,menuone,longest
" Limit popup menu height
set pumheight=15

set list listchars=tab:>\ ,trail:_,extends:>

set colorcolumn=80,100,120

set viminfo='0,:500,<0,@100,f0

call system("command -v docker-bazel >/dev/null 2>&1")
if v:shell_error == 0
    set makeprg=docker-bazel
else
    call system("command -v bazel >/dev/null 2>&1")
    if v:shell_error == 0
        set makeprg=bazel
    endif
endif

source ~/.vim/plugins.vim

source ~/.vim/backup.vim
source ~/.vim/ftdetect.vim
source ~/.vim/keymap.vim
source ~/.vim/appearance.vim

runtime! macros/matchit.vim
runtime! indent.vim
runtime! fvl.vim
